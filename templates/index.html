<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Monitoring Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div id="sidebar">
        <a href="#" onclick="showPage('introduce')" class="sidebar-link" data-page="introduce">Introduce</a>
        <a href="#" onclick="showPage('traffic-monitoring')" class="sidebar-link active">Traffic Monitoring</a>
        <a href="#" onclick="showPage('scan-results')" class="sidebar-link">Scan Results</a>
        <a href="#" onclick="showPage('wireshark-data')" class="sidebar-link">Wireshark Data</a>
        <a href="#" onclick="showPage('error-packet')" class="sidebar-link" data-page="error-packet">Error Packet</a> 
        <a href="#" onclick="showPage('add-rules')" class="sidebar-link">Add Rules</a> <!-- 新增 Add Rules 頁面 -->
    </div>

    <div id="content">
        <!-- Introduce Section -->
        <div id="introduce" class="content-page active">
            <h1>Welcome to Network Monitoring Dashboard</h1>
            <p>This dashboard provides tools to monitor, analyze, and troubleshoot network traffic and security data in real-time. Here’s a quick overview of each feature:</p>
            <section>
                <h2>Traffic Monitoring</h2>
                <p>Monitor the real-time network traffic on selected interfaces to understand bandwidth usage and traffic flow patterns.</p>
            </section>
            <section>
                <h2>Scan Results</h2>
                <p>View alerts and logs generated by Suricata to detect and analyze potential threats or anomalies in your network.</p>
            </section>
            <section>
                <h2>Wireshark Data</h2>
                <p>Capture and display real-time network packets, helping you dive deep into packet-level analysis for troubleshooting.</p>
            </section>
            <p>Explore each feature to gain insights into your network’s activity and security status.</p>
        </div>

        <!-- Traffic Monitoring Section -->
        <div id="traffic-monitoring" class="content-page">
            <h2>Traffic Monitoring</h2>
            <select id="interfaceSelect">
                <option value="lo" selected>lo (Local Loopback)</option>
            </select>
            <button onclick="startMonitoring()">Start Monitoring</button>
            <div style="width: 1700px; height: 700px;">
                <canvas id="trafficChart"></canvas>
            </div>
        </div>

        <!-- Suricata Scan Results Section -->
        <div id="scan-results" class="content-page">
            <h2>Scan Results</h2>
            <button id="startScanButton" onclick="startScan()">Start Scan</button>
            <table id="suricataResults">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Message</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- Wireshark Data Section -->
        <div id="wireshark-data" class="content-page">
            <h2>Wireshark Data</h2>
            <select id="wiresharkInterfaceSelect">
                <option value="lo" selected>lo (Local Loopback)</option>
            </select>
            <button onclick="startWireshark()">Start Wireshark</button>
            <table id="wiresharkResults">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                        <th>Protocol</th>
                        <th>Length</th>
                        <th>Info</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- Error Packet Section -->
        <div id="error-packet" class="content-page">
            <h2>Error Packet</h2>
            <button onclick="startErrorPacket()">Start Error Packet Monitoring</button>
            <p>Displaying packets that match Suricata rules for errors or suspicious activity.</p>
            <table id="errorPacketResults">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Time</th>
                        <th>Source IP</th>
                        <th>Destination IP</th>
                        <th>Protocol</th>
                        <th>Length</th>
                        <th>Info</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        
         <!-- Add Rules Section -->
        <div id="add-rules" class="content-page">
            <h2>Add Rules</h2>
            <label for="ruleInput">Enter your new rule:</label><br>
            <textarea id="ruleInput" rows="4" cols="50" placeholder="Enter Suricata rule here..."></textarea><br><br>
            
            <button onclick="addRule()">Add New Rule to a.rules</button><br><br>
            
            <label for="outputResult">Result:</label><br>
            <textarea id="outputResult" rows="4" cols="50" readonly></textarea>
        </div>

        <!-- Other Sections (e.g., Traffic Monitoring, Scan Results, Wireshark Data, Error Packet) -->
        <!-- existing content pages go here -->
        
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
</body>
</html>
